(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{605:function(s,t,a){s.exports=a.p+"assets/img/08-1.53838a28.png"},652:function(s,t,a){"use strict";a.r(t);var e=a(15),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"跨域认证"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#跨域认证"}},[s._v("#")]),s._v(" 跨域认证")]),s._v(" "),e("p",[s._v("互联网服务离不开用户认证:")]),s._v(" "),e("ul",[e("li",[s._v("用户向服务器发送用户名和密码。")]),s._v(" "),e("li",[s._v("服务器验证通过后，在当前对话（session）里面保存相关数据，比如用户角色、登录时间等等。")]),s._v(" "),e("li",[s._v("服务器向用户返回一个 session_id，写入用户的 Cookie。")]),s._v(" "),e("li",[s._v("用户随后的每一次请求，都会通过 Cookie，将 session_id 传回服务器。")]),s._v(" "),e("li",[s._v("服务器收到 session_id，找到前期保存的数据，由此得知用户的身份。")])]),s._v(" "),e("p",[s._v("缺点：")]),s._v(" "),e("ul",[e("li",[s._v("扩展性（scaling）不好。单机没有问题，如果是服务器集群，或者是跨域的服务导向架构，就要求 session 数据共享，每台服务器都能够读取 session。")])]),s._v(" "),e("p",[s._v("解决：")]),s._v(" "),e("ul",[e("li",[s._v("服务器不保存 session 数据，所有数据都保存在客户端，每次请求都发回服务器。JWT 就是这种方案的一个代表。")])]),s._v(" "),e("h2",{attrs:{id:"jwt-的原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jwt-的原理"}},[s._v("#")]),s._v(" JWT 的原理")]),s._v(" "),e("p",[s._v("JWT 的原理是，服务器认证以后，生成一个 JSON 对象，发回给用户")]),s._v(" "),e("div",{staticClass:"language-JSON line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"姓名"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"张三"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"角色"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"管理员"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"到期时间"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022年7月22日0点0分"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("用户与服务端通信的时候，都要发回这个 JSON 对象。服务器完全只靠这个对象认定用户身份。为了防止用户篡改数据，服务器在生成这个对象的时候，会加上签名")]),s._v(" "),e("h2",{attrs:{id:"jwt-的数据结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jwt-的数据结构"}},[s._v("#")]),s._v(" JWT 的数据结构")]),s._v(" "),e("p",[s._v("JWT 真实模样:")]),s._v(" "),e("img",{attrs:{src:a(605)}}),s._v(" "),e("p",[s._v("中间用点（.）分隔成三个部分,JWT 的三个部分是"),e("code",[s._v("Header.Payload.Signature")]),s._v("：")]),s._v(" "),e("ul",[e("li",[s._v("Header（头部）")]),s._v(" "),e("li",[s._v("Payload（负载）")]),s._v(" "),e("li",[s._v("Signature（签名）")])]),s._v(" "),e("h2",{attrs:{id:"jwt-的使用方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jwt-的使用方式"}},[s._v("#")]),s._v(" JWT 的使用方式")]),s._v(" "),e("ul",[e("li",[s._v("客户端收到服务器返回的 JWT，可以储存在 Cookie 里面，也可以储存在 localStorage。")]),s._v(" "),e("li",[s._v("客户端每次与服务器通信，都要带上这个 JWT。可以把它放在 Cookie 里面自动发送，这样不能跨域，更好的做法是放在 HTTP 请求的头信息Authorization字段里面。"),e("code",[s._v("Authorization: Bearer <token>")])]),s._v(" "),e("li",[s._v("另一种做法是，跨域的时候，JWT 就放在 POST 请求的数据体里面。")])])])}),[],!1,null,null,null);t.default=r.exports}}]);